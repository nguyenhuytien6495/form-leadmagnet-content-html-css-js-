<div>
    <div class="loyalty-program-setup-checklist">
        <div class="loyalty-program-setup-checklist__image">
            <img width="915" height="790" loading="lazy"
                src="https://avadaio_assets.storage.googleapis.com/uploads/2025/10/21094640/Form-the-loyalty-program-setup-checklist.png"
                alt="The Loyalty Program Set-up Checklist">
        </div>
        <div class="loyalty-program-setup-checklist__content" role="region" aria-labelledby="email-box-title">
            <div class="loyalty-program-setup-checklist__title" id="email-box-title">
                <span style="color: #080099;">The Loyalty Program</span> <span style="color: #FF6D6A;">Set-up
                    Checklist</span>
            </div>
            <p class="loyalty-program-setup-checklist__desc" style="text-align: left !important;">
                A step-by-step checklist to launch points, tiers, and rewards programs that boots retention and LTV.
            </p>
            <div class="loyalty-program-setup-checklist__features">
                <div class="loyalty-program-setup-checklist__feature">
                    <img class="loyalty-program-setup-checklist__feature-icon" loading="lazy" width="16" height="16"
                        src="https://avadaio_assets.storage.googleapis.com/uploads/2025/10/21101535/simple-line-icons_check.svg"
                        alt="tick">
                    <span class="loyalty-program-setup-checklist__feature-text">Clear steps</span>
                </div>
                <div class="loyalty-program-setup-checklist__feature">
                    <img class="loyalty-program-setup-checklist__feature-icon" loading="lazy" width="16" height="16"
                        src="https://avadaio_assets.storage.googleapis.com/uploads/2025/10/21101535/simple-line-icons_check.svg"
                        alt="tick">
                    <span class="loyalty-program-setup-checklist__feature-text">Real examples</span>
                </div>
                <div class="loyalty-program-setup-checklist__feature">
                    <img class="loyalty-program-setup-checklist__feature-icon" loading="lazy" width="16" height="16"
                        src="https://avadaio_assets.storage.googleapis.com/uploads/2025/10/21101535/simple-line-icons_check.svg"
                        alt="tick">
                    <span class="loyalty-program-setup-checklist__feature-text">Builtâ€‘in help</span>
                </div>
            </div>
            <form class="loyalty-program-setup-checklist__form" novalidate="">
                <label for="lead-email" class="sr-only">Email address</label>
                <input id="lead-email" name="email" type="email" placeholder="Enter your work email"
                    class="loyalty-program-setup-checklist__input" autocomplete="email" inputmode="email" required=""
                    aria-describedby="email-status">
                <!-- Honeypot for bots: keep visible to DOM but hidden off-screen -->
                <input id="lead-company" name="company" type="text" class="loyalty-program-setup-checklist__hp"
                    tabindex="-1" aria-hidden="true" autocomplete="off">
                <div class="loyalty-program-setup-checklist__status" id="email-status" role="status" aria-live="polite">
                </div>
                <button type="submit" class="loyalty-program-setup-checklist__btn" aria-label="Get the checklist">Get
                    your FREE
                    checklist</button>
                <p class="loyalty-program-setup-checklist__form-status" id="email-form-status" role="status"
                    aria-live="polite"></p>
            </form>
            <p class="loyalty-program-setup-checklist__note">Instant Access</p>
            <p class="loyalty-program-setup-checklist__status-notification" id="email-status-notification" role="status"
                aria-live="polite"></p>
        </div>
    </div>

    <style>
        .loyalty-program-setup-checklist {
            max-width: 100%;
            width: 800px;
            margin: 32px auto;

            display: flex;
            align-items: center;
            justify-content: center;

            font-family: inherit;
        }

        .loyalty-program-setup-checklist>* {
            flex-grow: 1;
            width: 50%;
            box-sizing: border-box;
        }

        .loyalty-program-setup-checklist .loyalty-program-setup-checklist__image img {
            max-width: 100%;
            height: auto;
        }

        .loyalty-program-setup-checklist__content {
            background: #fff;
            padding: 12px 24px;
            max-width: 100%;
            height: 100%;
        }

        .loyalty-program-setup-checklist__title {
            font-size: 28px;
            Line-height: 1.2;
            font-weight: bold;
            color: #1C1C1C;
        }

        .loyalty-program-setup-checklist__desc {
            font-size: 12px;
            color: #999;
            margin: 8px 0;
        }

        .loyalty-program-setup-checklist__features {
            margin: 16px 0;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 8px;
            justify-content: space-between;
        }

        .loyalty-program-setup-checklist__features>* {
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .loyalty-program-setup-checklist__form {
            display: flex;
            flex-direction: column;
            gap: 12px;
            align-items: stretch;
            position: relative;
        }

        .loyalty-program-setup-checklist__input {
            flex: 1;
            padding: 12px 14px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 8px;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .loyalty-program-setup-checklist__input:focus {
            outline: none;
            border-color: #4361EE;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }

        .loyalty-program-setup-checklist__input:invalid {
            border-color: #ef4444;
        }

        .loyalty-program-setup-checklist__input:invalid:focus {
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }

        .loyalty-program-setup-checklist__btn {
            white-space: nowrap;
            text-align: center;
            background: #FF6D6A;
            color: #fff;
            font-weight: bold;
            font-size: 16px;
            padding: 12px 20px;
            border-radius: 8px;
            text-decoration: none;
            box-shadow: 0 4px 12px rgba(67, 97, 238, 0.3);
            transition: all 0.2s ease;
            display: inline-block;
            border: none;
            cursor: pointer;
            font-family: inherit;
        }

        .loyalty-program-setup-checklist__btn:hover {
            filter: brightness(1.08);
            box-shadow: 0 6px 16px rgba(67, 97, 238, 0.4);
        }

        .loyalty-program-setup-checklist__btn:disabled {
            cursor: not-allowed;
            opacity: 0.7;
            box-shadow: none;
        }

        .loyalty-program-setup-checklist__note {
            max-width: 10px 0;
            font-size: 14px;
            font-style: italic;
            text-align: center !important;
            margin-top: 10px !important;
            margin-bottom: 0px !important;
        }

        .loyalty-program-setup-checklist__status {
            font-size: 0px;
            position: absolute;
        }

        .loyalty-program-setup-checklist__status-notification {
            margin-top: 8px;
            margin-bottom: 0px !important;
            font-size: 14px;
            text-align: center !important;
            font-weight: 500;
        }

        .loyalty-program-setup-checklist__status-notification--error {
            color: #d32f2f;
        }

        .loyalty-program-setup-checklist__status-notification--success {
            color: #2e7d32;
        }

        .loyalty-program-setup-checklist__form-status {
            font-size: 0px;
            position: absolute;
            left: -9999px;
            top: auto;
        }

        .loyalty-program-setup-checklist__hp {
            position: absolute;
            left: -10000px;
            top: auto;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Mobile stacking */
        @media (max-width: 959px) {
            .loyalty-program-setup-checklist {
                flex-direction: column;
            }

            .loyalty-program-setup-checklist>* {
                width: 100%;
            }
        }
    </style>
    <script>
        (function () {
            const scriptURL = 'https://script.google.com/macros/s/AKfycbyedWYtD60qW5buMsOofdriwG_p7UJNESbpz9oF8-1pvg5h7N5LqqZXLNSckhFY32s8Zg/exec';
            const container = document.querySelector('.loyalty-program-setup-checklist');
            if (!container) return;

            const form = container.querySelector('form.loyalty-program-setup-checklist__form');
            const input = container.querySelector('.loyalty-program-setup-checklist__input');
            const button = container.querySelector('.loyalty-program-setup-checklist__btn');
            const statusText = container.querySelector('.loyalty-program-setup-checklist__status');
            const statusNotification = container.querySelector('.loyalty-program-setup-checklist__status-notification');
            const formStatus = container.querySelector('.loyalty-program-setup-checklist__form-status');
            const honeypot = container.querySelector('input[name="company"]');

            // Prefill from localStorage if available
            try {
                const saved = localStorage.getItem('lead_email');
                if (saved) input.value = saved;
            } catch (e) { /* ignore */ }

            let isSubmitting = false;

            form.addEventListener('submit', async function (e) {
                e.preventDefault();
                if (isSubmitting) return;

                clearStatus();

                const email = (input.value || '').trim();
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

                if (!email) {
                    showError('Please enter your email!');
                    input.focus();
                    return;
                }
                if (!emailRegex.test(email)) {
                    showError('Please enter a valid email address (e.g., example@email.com)');
                    input.focus();
                    return;
                }

                // If honeypot is filled, probably a bot: pretend success
                if (honeypot && honeypot.value) {
                    openChecklist();
                    return;
                }

                isSubmitting = true;
                setLoading(true);

                // Save email for convenience next time
                try { localStorage.setItem('lead_email', email); } catch (e) { /* ignore */ }

                const pageUrl = window.location.href;

                // Open the checklist immediately to avoid any delay
                const checklistUrl = 'https://docs.google.com/document/d/1Wwb3Sdq-7O--zPakwjZdACfqa6ZbX4ifhYwTP5VuCCo/copy';
                const preOpened = window.open(checklistUrl, '_blank');

                // Abort fetch if it hangs too long
                const controller = ('AbortController' in window) ? new AbortController() : null;
                const signal = controller ? controller.signal : undefined;
                const timeoutId = controller ? setTimeout(() => controller.abort(), 10000) : null; // 10s

                try {
                    await fetch(scriptURL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email, url: pageUrl, userAgent: navigator.userAgent }),
                        signal
                    }).catch(function () { /* swallow since no-cors gives opaque */ });
                    showSuccessMessage();
                } catch (err) {
                    // Even on error (timeout/abort), continue to open checklist for user experience
                    showSuccessMessage();
                } finally {
                    if (timeoutId) clearTimeout(timeoutId);
                    input.value = '';
                    setLoading(false);
                    isSubmitting = false;
                    // Clear message after a moment to reduce clutter
                    setTimeout(clearStatus, 4000);
                }
            });

            function setLoading(loading) {
                button.disabled = loading;
                button.setAttribute('aria-busy', String(loading));
                button.textContent = loading ? 'Submitting...' : 'Get your FREE checklist';
            }

            function setStatusText(text) {
                if (statusText) {
                    statusText.textContent = text;
                    statusText.className = 'loyalty-program-setup-checklist__status';
                    if (text === 'success') {
                        statusText.classList.add('success');
                    } else if (text === '- Fail') {
                        statusText.classList.add('- Fail');
                    }
                }
            }

            function clearStatusText() {
                if (statusText) {
                    statusText.textContent = '';
                    statusText.className = 'loyalty-program-setup-checklist__status';
                }
            }

            function showSuccessMessage() {
                setStatusText('success');
                if (statusNotification) {
                    statusNotification.classList.remove('loyalty-program-setup-checklist__status-notification--error');
                    statusNotification.classList.add('loyalty-program-setup-checklist__status-notification--success');
                    statusNotification.textContent = 'Your checklist is opening in a new tab...';
                }
                if (formStatus) {
                    formStatus.textContent = 'success';
                }
            }

            function showError(message) {
                setStatusText('- Fail');
                if (statusNotification) {
                    statusNotification.textContent = message;
                    statusNotification.classList.remove('loyalty-program-setup-checklist__status-notification--success');
                    statusNotification.classList.add('loyalty-program-setup-checklist__status-notification--error');
                } else {
                    alert(message);
                }
                if (formStatus) {
                    formStatus.textContent = '- Fail';
                }
            }

            function clearStatus() {
                clearStatusText();
                if (statusNotification) {
                    statusNotification.textContent = '';
                    statusNotification.classList.remove('loyalty-program-setup-checklist__status-notification--error', 'loyalty-program-setup-checklist__status-notification--success');
                }
                if (formStatus) {
                    formStatus.textContent = '';
                }
            }

            // openChecklist helper no longer needed since we navigate immediately
        })();
    </script>
</div>